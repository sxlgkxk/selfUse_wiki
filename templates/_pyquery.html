{% extends "layout.html" %}{% block body %}<h1><a href='/c/wiki/tech/linux技术/爬虫'>wiki/tech/linux技术/爬虫 </a> pyquery </h1><hr/><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
</head>
<body>
<div id="TOC">
<ul>
<li><a href="#字符串初始化">字符串初始化</a></li>
<li><a href="#url初始化">URL初始化</a></li>
<li><a href="#文件初始化">文件初始化</a></li>
<li><a href="#css选择器">CSS选择器</a></li>
<li><a href="#子元素find">子元素（find）</a></li>
<li><a href="#父元素">父元素</a></li>
<li><a href="#父元素2">父元素2</a></li>
<li><a href="#将所有祖先节点返回">将所有祖先节点返回</a></li>
<li><a href="#兄弟元素">兄弟元素</a></li>
<li><a href="#在向其中筛选">在向其中筛选</a></li>
<li><a href="#单个元素">单个元素</a></li>
<li><a href="#获取属性">获取属性</a></li>
<li><a href="#获取文本">获取文本</a></li>
<li><a href="#获取html">获取HTML</a></li>
<li><a href="#addclassremoveclass">addClass，removeClass</a></li>
<li><a href="#attrcss">attr、css</a></li>
<li><a href="#remove">remove</a></li>
<li><a href="#伪类选择器">伪类选择器</a></li>
</ul>
</div>
<p>目录：</p>
<p>一、什么是PyQuery库？</p>
<p>二、安装</p>
<p>三、PyQuery库用法详解</p>
<p>一、什么是PyQuery库？</p>
<p>强大而灵活的网页解析库。如果你觉得正则写起来太麻烦，如果你觉得BeautifulSoup语法太难记，如果你熟悉jQuery的语法，那么PyQuery就是你的绝佳选择！！！</p>
<p>二、安装</p>
<p>pip install pyquery 三、PyQuery用法讲解</p>
<p>初始化（3种）</p>
<h1 id="字符串初始化">字符串初始化</h1>
html = '''
<div>
<ul>
<pre><code>   &lt;li class=&quot;item-0&quot;&gt;first item&lt;/li&gt;
   &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;&gt;/li
   &lt;li class=&quot;item-0 active&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;boid&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
   &lt;li class=&quot;item-1 active&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt;
   &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt;&lt;/li&gt;</code></pre>
</ul>
</div>
<p>'''</p>
<p>from pyquery import PyQuery as pq</p>
<p>doc = pq(html)</p>
<p>print(doc('li'))#选择器实际上就是CSS选择器，即：选id就加“#”，选class前面加“.”</p>
<h1 id="url初始化">URL初始化</h1>
<p>doc1 = pq(url = &quot;http://www.baidu.com&quot;)</p>
<p>print(doc1(&quot;head&quot;))</p>
<h1 id="文件初始化">文件初始化</h1>
<p>doc2 = pq(filename = &quot;demo.html&quot;)#自己下载一个HTML文件</p>
<p>print(doc2('li')) 基本CSS选择器</p>
<h1 id="css选择器">CSS选择器</h1>
html = '''
<div id="container">
<ul class="list">
<pre><code>   &lt;li class=&quot;item-0&quot;&gt;first item&lt;/li&gt;
   &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;&gt;/li
   &lt;li class=&quot;item-0 active&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;boid&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
   &lt;li class=&quot;item-1 active&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt;
   &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt;&lt;/li&gt;</code></pre>
</ul>
</div>
<p>'''</p>
<p>doc3 = pq(html)</p>
<p>print(doc3(&quot;#container .list li&quot;))#注意空格，空格代表嵌套关系 查找元素</p>
<p>子元素</p>
<h1 id="子元素find">子元素（find）</h1>
html = '''
<div id="container">
<ul class="list">
<pre><code>   &lt;li class=&quot;item-0&quot;&gt;first item&lt;/li&gt;
   &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;&gt;/li
   &lt;li class=&quot;item-0 active&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;boid&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
   &lt;li class=&quot;item-1 active&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt;
   &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt;&lt;/li&gt;</code></pre>
</ul>
</div>
<p>'''</p>
<p>from pyquery import PyQuery as pq</p>
<p>doc = pq(html)</p>
<p>items = doc(&quot;.list&quot;)#首先选中url标签</p>
<p>print(type(items))</p>
<p>print(items)</p>
<p>lis = items.find('li')#实际上也是一个CSS选择器，将里面所有的li标签都打印出来；只要在它里面的标签都可以找到</p>
<p>print(type(lis))</p>
<p>print(lis) #查找直接子元素 lis2 = items.children()</p>
<p>print(type(lis2))</p>
<p>print(lis2)</p>
<p>lis3 = items.children('.active')</p>
<p>print(lis3) 父元素</p>
<h1 id="父元素">父元素</h1>
html = '''
<div id="container">
<ul class="list">
<pre><code>   &lt;li class=&quot;item-0&quot;&gt;first item&lt;/li&gt;
   &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;/li&gt;
   &lt;li class=&quot;item-0 active&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;boid&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
   &lt;li class=&quot;item-1 active&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt;
   &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt;&lt;/li&gt;</code></pre>
</ul>
</div>
<p>'''</p>
<p>from pyquery import PyQuery as pq</p>
<p>doc = pq(html)</p>
<p>items = doc(&quot;.list&quot;)#首先选中url标签 #每个标签外面肯定只能套一个父元素 container = items.parent()</p>
<p>print(type(container))</p>
<p>print(container)</p>
<h1 id="父元素2">父元素2</h1>
html = '''
<div class="wrap">
<pre><code>&lt;div id=&quot;container&quot;&gt;
    &lt;ul class=&quot;list&quot;&gt;
        &lt;li class=&quot;item-0&quot;&gt;first item&lt;/li&gt;
        &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;&gt;/li
        &lt;li class=&quot;item-0 active&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;boid&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
        &lt;li class=&quot;item-1 active&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt;
        &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
&lt;/div&gt;</code></pre>
</div>
<p>'''</p>
<p>from pyquery import PyQuery as pq</p>
<p>doc = pq(html)</p>
<p>items = doc(&quot;.list&quot;)#首先选中url标签</p>
<h1 id="将所有祖先节点返回">将所有祖先节点返回</h1>
<p>parents = items.parents()</p>
<p>print(parents)</p>
<p>print(type(parents))#打印出两个div #在其中进行搜索 doc = pq(html)</p>
<p>items = doc(&quot;.list&quot;)</p>
<p>parents1 = items.parents(&quot;.wrap&quot;)</p>
<p>print(parents1)#通过筛选，只剩下一个div 兄弟元素</p>
<h1 id="兄弟元素">兄弟元素</h1>
html = '''
<div class="wrap">
<pre><code>&lt;div id=&quot;container&quot;&gt;
    &lt;ul class=&quot;list&quot;&gt;
        &lt;li class=&quot;item-0&quot;&gt;first item&lt;/li&gt;
        &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;&gt;/li
        &lt;li class=&quot;item-0 active&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;boid&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
        &lt;li class=&quot;item-1 active&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt;
        &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
&lt;/div&gt;</code></pre>
</div>
<p>'''</p>
<p>from pyquery import PyQuery as pq</p>
<p>doc = pq(html)</p>
<p>li = doc('.list .item-0.active')#首先选class=“.list”，空格即使选择list里面的标签，再选class=“item-0”，并列active（实际就是一个整体）</p>
<p>print(li.siblings())#获取所有的兄弟元素</p>
<h1 id="在向其中筛选">在向其中筛选</h1>
<p>print(li.siblings('.active')) 遍历</p>
<h1 id="单个元素">单个元素</h1>
html = '''
<div class="wrap">
<div id="container">
<pre><code>   &lt;ul class=&quot;list&quot;&gt;
       &lt;li class=&quot;item-0&quot;&gt;first item&lt;/li&gt;
       &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;/li&gt;
       &lt;li class=&quot;item-0 active&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;boid&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
       &lt;li class=&quot;item-1 active&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt;
       &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt;&lt;/li&gt;
   &lt;/ul&gt;</code></pre>
</div>
</div>
<p>'''</p>
<p>from pyquery import PyQuery as pq</p>
<p>doc = pq(html)</p>
<p>li = doc(&quot;.item-0.active&quot;)</p>
<p>print(li)</p>
<p>lis = doc('li').items()#多个元素，进行遍历，生成一个产生器</p>
<p>print(type(lis))</p>
<p>for li in lis: print(li) 获取信息</p>
<h1 id="获取属性">获取属性</h1>
html = '''
<div class="wrap">
<div id="container">
<pre><code>   &lt;ul class=&quot;list&quot;&gt;
       &lt;li class=&quot;item-0&quot;&gt;first item&lt;/li&gt;
       &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;/li&gt;
       &lt;li class=&quot;item-0 active&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;boid&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
       &lt;li class=&quot;item-1 active&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt;
       &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt;&lt;/li&gt;
   &lt;/ul&gt;</code></pre>
</div>
</div>
<p>'''</p>
<p>from pyquery import PyQuery as pq</p>
<p>doc = pq(html)</p>
<p>a = doc(&quot;.item-0.active a&quot;)#选择class同时为item-0和active，在选择class里面的啊标签，中间注意空格</p>
<p>print(a)</p>
<p>print(a.attr(&quot;href&quot;))</p>
<p>print(a.attr.href)#结果同上</p>
<h1 id="获取文本">获取文本</h1>
<p>print(a.text())#将上面的选中的class中包围的文字</p>
<h1 id="获取html">获取HTML</h1>
<p>a1 = doc(&quot;.item-0.active&quot;)</p>
<p>print(a1.html()) DOM操作</p>
<h1 id="addclassremoveclass">addClass，removeClass</h1>
html = '''
<div class="wrap">
<div id="container">
<pre><code>   &lt;ul class=&quot;list&quot;&gt;
       &lt;li class=&quot;item-0&quot;&gt;first item&lt;/li&gt;
       &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;/li&gt;
       &lt;li class=&quot;item-0 active&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;boid&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
       &lt;li class=&quot;item-1 active&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt;
       &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt;&lt;/li&gt;
   &lt;/ul&gt;</code></pre>
</div>
</div>
<p>'''</p>
<p>from pyquery import PyQuery as pq</p>
<p>doc = pq(html)</p>
<p>li = doc(&quot;.item-0.active&quot;)</p>
<p>print(li)</p>
<p>li.removeClass(&quot;active&quot;)#移除active</p>
<p>print(li)</p>
<p>li.addClass(&quot;active&quot;)#增加active</p>
<p>print(li)</p>
<h1 id="attrcss">attr、css</h1>
<p>doc = pq(html) li = doc(&quot;.item-0.active&quot;)</p>
<p>li.attr(&quot;name&quot;,&quot;link&quot;)#若存在，就会覆盖</p>
<p>print(li)</p>
<p>li.css(&quot;font-size&quot;,&quot;14px&quot;)#增加style属性</p>
<p>print(li)</p>
<h1 id="remove">remove</h1>
html1 = '''
<div class="wrap">
Hello,World
<p>
This is a paragraph.
</p>
</div>
<p>'''</p>
<p>from pyquery import PyQuery as pq</p>
<p>doc = pq(html1)</p>
<p>wrap = doc(&quot;.wrap&quot;)</p>
<p>print(wrap.text())</p>
<p>wrap.find('p').remove()</p>
<p>print(wrap.text()) 其他DOM方法：</p>
<p>pyquery: a jquery-like library for python ​ pythonhosted.org</p>
<h1 id="伪类选择器">伪类选择器</h1>
html = '''
<div class="wrap">
<div id="container">
<pre><code>   &lt;ul class=&quot;list&quot;&gt;
       &lt;li class=&quot;item-0&quot;&gt;first item&lt;/li&gt;
       &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;/li&gt;
       &lt;li class=&quot;item-0 active&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;&lt;span class=&quot;boid&quot;&gt;third item&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
       &lt;li class=&quot;item-1 active&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt;
       &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt;&lt;/li&gt;
   &lt;/ul&gt;</code></pre>
</div>
</div>
<p>'''</p>
<p>from pyquery import PyQuery as pq</p>
<p>doc = pq(html)</p>
<p>li = doc(&quot;li:first-child&quot;)#第一个</p>
<p>print(li)</p>
<p>li1 = doc('li:last-child')#最后一个</p>
<p>print(li1)</p>
<p>li2 = doc('li:nth-child(2)')#指定缩写顺序，第二个</p>
<p>print(li2)</p>
<p>li3 = doc(&quot;li:gt(2)&quot;)#大于2的</p>
<p>print(li3)</p>
<p>li4 = doc(&quot;li:nth-child(2n)&quot;)#偶数</p>
<p>print(li4)</p>
<p>li5 = doc(&quot;li:contains(second)&quot;)#内容包含second</p>
<p>print(li5) 更多CSS选择器可以查看：</p>
</body>
</html>{% endblock %}